<!DOCTYPE html>

<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
  <title>WA信息仿真决策支持系统</title>
  <link rel="stylesheet" href="css/app.css" />
</head>

<body>
<div id="datav-loading">
  <a target="_blank" href="javascript:;">
    <img src="img/loading.gif">
  </a>
</div>
<div id="datav-layout" style="visibility: hidden;">
  <div class="header">
    <h1 class="header-title">WA信息仿真决策支持系统</h1>
  </div>
  <div class="wrapper">
    <div class="content">
      <div class="col col-l">
        <div class="xpanel-wrapper xpanel-wrapper-40">
          <div class="xpanel xpanel-l-t">
            <div class="title">"社会雷达"感知数据源</div>
            <div>242141条</div>
          </div>
        </div>
        <div class="xpanel-wrapper xpanel-wrapper-60">
          <div class="xpanel xpanel-l-b">
            <div class="title">涉政信息</div>
          </div>
        </div>
      </div>
      <div class="col col-c">
        <div class="xpanel-wrapper xpanel-wrapper-70">
          <div class="xpanel no-bg" style="padding-top: 20px;">
            <div class="title title-long">事件传播可视化展示</div>
            <div id="seriesGraph" style="height: 100%"></div>
          </div>
        </div>
        <div class="xpanel-wrapper xpanel-wrapper-30">
          <div class="xpanel xpanel-c-b">
            <div class="title title-long">事件发展趋势图</div>
            <div id="lineChart" style="height: 100%"></div>
          </div>
        </div>
      </div>
      <div class="col col-r">
        <div class="xpanel-wrapper xpanel-wrapper-25">
          <div class="xpanel xpanel-r-t">
            <div class="title">WA信息关键词云</div>
          </div>
        </div>
        <div class="xpanel-wrapper xpanel-wrapper-30">
          <div class="xpanel xpanel-r-m">
            <div class="title">事件影响力趋势图</div>
            <div id="barChart" style="height: 100%"></div>
          </div>
        </div>
        <div class="xpanel-wrapper xpanel-wrapper-45">
          <div class="xpanel xpanel-r-b">
            <div class="title">事件干预效果图</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<script type="text/javascript" src="js/jquery-3.3.1.min.js"></script>
<script type="text/javascript" src="js/echarts-3.8.5.min.js"></script>
<script type="text/javascript" src="js/dataTool.min.js"></script>
<!--    <script async src="js/a.js"></script>-->
<!--    <script defer src="js/b.js"></script>-->
<script>
  $(function () {
    /*************** 事件传播可视化展示 **************/
    const seriesGraph = echarts.init(document.getElementById("seriesGraph"));
    // seriesGraph.showLoading();
    $.ajax('data/Untitled.gexf').done(function (xml) {
      // seriesGraph.hideLoading();

      const graph = echarts.dataTool.gexf.parse(xml);
      console.log(graph)
      const categories = [];
      for (let i = 0; i < 8; i++) {
        categories[i] = {
          name: '类目' + i
        };
      }
      graph.nodes.forEach(function (node) {
        node.itemStyle = null;
        node.value = node.symbolSize;
        node.symbolSize /= 1.5;
        node.label = {
          normal: {
            show: node.symbolSize > 30
          }
        };
        node.category = node.attributes.modularity_class;
      });
      let option = {
        tooltip: {},
        legend: [{
          // selectedMode: 'single',
          data: categories.map(function (a) {
            return a.name;
          })
        }],
        animationDuration: 1500,
        animationEasingUpdate: 'quinticInOut',
        series: [
          {
            type: 'graph',
            layout: 'none',
            data: graph.nodes,
            links: graph.links,
            categories: categories,
            roam: false,
            focusNodeAdjacency: true,
            itemStyle: {
              normal: {
                borderColor: '#fff',
                borderWidth: 1,
                shadowBlur: 10,
                shadowColor: 'rgba(0, 0, 0, 0.3)'
              }
            },
            label: {
              position: 'right',
              formatter: '{b}'
            },
            lineStyle: {
              color: 'source',
              curveness: 0.3
            },
            emphasis: {
              lineStyle: {
                width: 10
              }
            }
          }
        ]
      };
      seriesGraph.setOption(option);
    });

    /*************** 事件发展趋势图 **************/
    const lineChart = echarts.init(document.getElementById("lineChart"));
    (function () {
      const option = {
        grid: {
          top: 15,
        },
        xAxis: {
          type: 'category',
          data: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun']
        },
        yAxis: {
          type: 'value',
        },
        series: [{
          data: [820, 932, 901, 934, 1290, 1330, 1320],
          type: 'line',
          smooth: true
        }]
      };
      lineChart.setOption(option, true);
    })();

    /*************** 事件影响力趋势图 **************/
    const barChart = echarts.init(document.getElementById("barChart"));
    (function () {
      const option = {
        xAxis: {
          type: 'time',
          splitLine: { show: false },
        },
        yAxis: {
          type: 'category',
          data: ['酝酿期', '产生期'],
        },
        grid: {
          left: '5%',
          right: '10%',
          top: '10%',
          containLabel: true
        },
        series: [
          {
            name: '辅助',
            type: 'bar',
            stack: 'zl',
            itemStyle: {
              normal: {
                barBorderColor: 'rgba(0,0,0,0)',
                color: 'rgba(0,0,0,0)'
              },
              emphasis: {
                barBorderColor: 'rgba(0,0,0,0)',
                color: 'rgba(0,0,0,0)'
              }
            },
            data: [new Date().setFullYear(2015, 7, 25), new Date().setFullYear(2015, 7, 26)],
          },
          {
            name: '日期',
            type: 'bar',
            stack: 'zl',
            data: [new Date().setFullYear(2015, 7, 26), new Date().setFullYear(2015, 7, 27)]
          }
        ]
      };
      barChart.setOption(option, true);
    })();

    $('#datav-layout').css('visibility', 'visible');
    $('#datav-loading').fadeOut();
  });
</script>
</body>
</html>
